---
title: "Dependencia de una función de distribución dado sus parémetros"
author: "Imelda"
date: "2025-08-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


rm(list = ls())

# Cargar librería
library(ggplot2)

```


# 1. Change the value of a parameter to simulated data


En la clase anterior introdujimos una serie de funciones de desidades de probabilidad $f(x)$ que dependen de parámetros $\theta$. 
Para enfatizar esta dependencia usaremos la siguiente notación:

\[
X \sim f(x \mid \theta)
\]

donde $\theta$ puede ser un vector de parámetros o un escalar.

\medskip

El objetivo del laboratorio es entender cómo $\theta$ modifica la forma o tendencia de la distribución.

\subsubsection*{Tipos de Parámetros}

\begin{itemize}
    \item \textbf{Parámetros de localización:} desplazan la distribución horizontalmente.
    \item \textbf{Parámetros de escala:} estiran o comprimen la distribución.
    \item \textbf{Parámetros de forma:} cambian la forma fundamental de la distribución.
\end{itemize}

\medskip

Para estas prácticas sugerimos leer los Capítulos 3 y 4 del libro de clase:

\begin{quote}
Kruschke, John K. \\
\emph{Doing Bayesian Data Analysis: A Tutorial with R, JAGS, and Stan}, 2a edición.
\end{quote}

y la documentación de las funciones de densidad en R.

Ejemplo: 

-- https://search.r-project.org/CRAN/refmans/ExtDist/html/Gamma.html
En R, nosotros podemos buscar ayuda usando el simbolo de interogacion "?"

Practica 1: Genera una sucesión de observaciones/datos usando una función de densidad binomial con n=20 (size), y probabilidad de éxito $\theta=0.2$, i.e,

$$Y \sim f(y \mid n=20, \theta= 0.2) = Binomial (20, 0.2) $$


```{r help in R}
#?Binomial
```

#1.1 Distribución binomial

```{r question}
#set a seed

set.seed(1)

# Número de observaciones que queremos simular
n <- 1000  

# Parámetros de la distribución binomial (20,0.6)
size1 <- 20      # número de ensayos
prob1 <- 0.6     # probabilidad de éxito


# Generar las observaciones: datos1

datos1 <- rbinom(n, size = size1, prob = prob1)

print(datos1)

summary(datos1)


# Generar otras observaciones: datos2

prob2 <- 0.2

datos2 <- rbinom(n, size = size1, prob = prob2)

print(datos2)

summary(datos2)

#


# -----------------------------
# Crear un data.frame combinado
# -----------------------------
df <- data.frame(
  valor = c(datos1, datos2),                       # todos los datos juntos
  grupo = factor(rep(c("Binomial p=0.6", "Binomial p=0.2"), each = n))
)

# -----------------------------
# Graficar histogramas superpuestos
# -----------------------------
ggplot(df, aes(x = valor, fill = grupo)) +
  geom_histogram() +
  labs(
    title = "Comparación de dos distribuciones Binomiales",
    x = "Número de éxitos",
    y = "Frecuencia",
    fill = "Distribución"
  ) 
```

# 1.2 Distibución normal

```{r normal}
# --------------------------------------------------------
# Laboratorio: Dependencia de la distribución Normal en sus parámetros
# --------------------------------------------------------

# -----------------------------
# Parámetros de la distribución Normal
# -----------------------------
mu1 <- 0      # media
sigma1 <- 1   # desviación estándar

mu2 <- 0      # media diferente
sigma2 <- 3   # desviación estándar diferente

# -----------------------------
# Generar las observaciones
# -----------------------------
datos_norm1 <- rnorm(n, mean = mu1, sd = sigma1)
datos_norm2 <- rnorm(n, mean = mu2, sd = sigma2)

# Resumen de los datos
summary(datos_norm1)
summary(datos_norm2)

# -----------------------------
# Crear data.frame combinado
# -----------------------------
df_norm <- data.frame(
  valor = c(datos_norm1, datos_norm2),
  grupo = factor(rep(c(
    paste0("Normal μ=", mu1, ", σ=", sigma1),
    paste0("Normal μ=", mu2, ", σ=", sigma2)
  ), each = n))
)

# -----------------------------
# Graficar histogramas superpuestos
# -----------------------------
ggplot(df_norm, aes(x = valor, fill = grupo)) +
  geom_histogram(position = "identity", alpha = 0.4, bins = 30, color = "black") +
  labs(
    title = "Comparación de dos distribuciones Normales",
    x = "Valores simulados",
    y = "Frecuencia",
    fill = "Distribución"
  ) +
  theme_minimal(base_size = 14)


```


```{r teoria}
# -----------------------------
# Superponer la densidad teórica
# -----------------------------
x_seq <- seq(min(df_norm$valor), max(df_norm$valor), length.out = 500)
y1 <- dnorm(x_seq, mean = mu1, sd = sigma1) * n * diff(range(x_seq))/30
y2 <- dnorm(x_seq, mean = mu2, sd = sigma2) * n * diff(range(x_seq))/30

# add another normal distribution with mu3 diferent from 0. 


# Crear un data.frame largo (long format) para ggplot
df_dens <- data.frame(
  x = rep(x_seq, 2),
  y = c(y1, y2),
  grupo = factor(rep(c(
    paste0("Normal μ=", mu1, ", σ=", sigma1),
    paste0("Normal μ=", mu2, ", σ=", sigma2)
  ), each = length(x_seq)))
)

# Graficar solo las curvas de densidad
ggplot(df_dens, aes(x = x, y = y, color = grupo)) +
  geom_line(size = 1.2) +
  labs(
    title = "Curvas de densidad teóricas de dos Normales",
    x = "x",
    y = "Densidad",
    color = "Distribución"
  ) +
  theme_minimal(base_size = 14)


```

#1.3 Distribción gamma 


#1.4 Distribucion beta


## 2. Observación

En los ejemplos anteriores generamos datos **simulados**, usando parámetros que **conocemos** (\(\mu, \sigma\) para la Normal o \(n, \theta\) para la Binomial).  

Matemáticamente, esto corresponde a calcular la **verosimilitud** de los datos dado los parámetros conocidos:

\[
\mathrm{P}(\text{Datos} \mid \text{Parámetros})
\]

### Inferencia Bayesiana

En inferencia bayesiana, el objetivo es el **inverso**: estimar los parámetros **dado los datos observados**:

$${P}(\text{Parámetros} \mid \text{Datos}) $$

 **Resumen intuitivo:**  

- **Simulación:** parámetros conocidos → datos simulados  
- **Bayes:** datos observados → parámetros desconocidos  
